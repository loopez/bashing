#Ce script AWK affiche un beau tableau avec les informations du disque (le r√©sultat de la commande df -Ph)

#[root@localhost bin]# df -Ph | tail -n +2 | tr -s " " ":" | awk -f etat_disque.awk 
# -----------------------------------------------------------------------------------------------------------
#|                                    Etat recapitulatif de l'espace disque                                  |
# -----------------------------------------------------------------------------------------------------------
#|Systeme de fichiers           |Capacite|Occupation|Disponible|    Taux occup. |Point de montage|Observation|
# -----------------------------------------------------------------------------------------------------------
#|/dev/mapper/VolGroup-lv_root  |     20G|      7,2G|       12G|             38%|/               |        OK |
#|tmpfs                         |    513M|      228K|      513M|              1%|/dev/shm        |        OK |
#|/dev/sda1                     |    477M|      106M|      346M|             24%|/boot           |        OK |
# -----------------------------------------------------------------------------------------------------------

BEGIN{
FS = ":"
print " -----------------------------------------------------------------------------------------------------------"
print "|                                    Etat recapitulatif de l'espace disque                                  |"
print " -----------------------------------------------------------------------------------------------------------"
printf "|%-30s|%8s|%8s|%8s|%16s|%-15s|%11s|\n", "Systeme de fichiers", "Capacite", "Occupation", "Disponible", "Taux occup. " , "Point de montage", "Observation"
print " -----------------------------------------------------------------------------------------------------------"
}
{
if($5<75)
{ printf "|%-30s|%8s|%10s|%10s|%15d%%|%-16s|%11s|\n", $1, $2, $3, $4, $5, $6, "OK ";}
else if ($5>=75 && $5<=80)
{ printf "|%-30s|%8s|%10s|%10s|%15d%%|%-16s|%11s|\n", $1, $2, $3, $4, $5, $6, "Warning";}
else if ($5>=81 && $5<=95)
{ printf "|%-30s|%8s|%10s|%10s|%15d%%|%-16s|%11s|\n", $1, $2, $3, $4, $5, $6, "Critical ";}
else if($5>=96)
{ printf "|%-30s|%8s|%10s|%10s|%15d%%|%-16s|%11s|\n", $1, $2, $3, $4, $5, $6, "Alarm";}
}
END{
print " -----------------------------------------------------------------------------------------------------------"
}
